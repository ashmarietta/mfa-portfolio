<!DOCTYPE html>
<html>
<head>
  <title>Allison Marietta — Writing</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Source+Serif+4:wght@400;500&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>

  <div class="layout">
    <aside class="sidebar">
      <h2>Allison Marietta</h2>
      <nav>
        <a href="/">Who I Am</a>
        <a href="/">What I’m Working On</a>
        <a href="/">What I’ve Written</a>
        <a href="/">How To Reach Me</a>
      </nav>
    </aside>

    <main class="content">
      <article id="article"></article>
    </main>
  </div>

  <script>
  async function loadArticle() {
    const params = new URLSearchParams(window.location.search);
    const slug = params.get("slug");

    if (!slug) return;

    const res = await fetch(`/content/works/${slug}.md`);
    const raw = await res.text();

    let title = "Untitled";
    let body = raw;

    // ---------- Strip YAML front-matter ----------
    if (raw.startsWith('---')) {
      const parts = raw.split('---');

      // YAML lives in parts[1]
      const yaml = parts[1];
      body = parts.slice(2).join('---').trim();

      yaml.split('\n').forEach(line => {
        if (line.toLowerCase().startsWith("title:")) {
          title = line.split(":").slice(1).join(":").trim();
        }
      });
    }

    // ---------- Render ----------
    document.getElementById("article").innerHTML = `
      <h1>${title}</h1>
      ${marked.parse(body)}
    `;
  }

  loadArticle();
  </script>

</body>
</html>